---
layout: single
title:  "NetworkX 배우기(with python)" #파이썬 스터디 2주차(Part2: 빅데이터 분석)
categories:
   - python
---
# NetworkX 
---

NetworkX는 파이썬 기반의 모듈로, 다양한 그래프 알고리즘을 제공한다.

이를 이용해서 노드와 엣지로 연결된 네트워크를 분석할 수 있다.

우선, 이렇게 networkx를 nx라는 이름으로 가져와서 그래프를 작성할 환경을 준비한다.

```python
import networkx as nx
G = nx.Graph
```

#### 1. 노드/엣지의 삽입

이제 준비된 빈 그래프에 노드 1개를 만들고 그 내용을 출력해보았다.

노드를 삽입할 때는 add_node() 라는 메소드를 사용하고, 값을 입력하면 해당 노드의 라벨(lable)로 지정된다. 

nodes() 메소드를 사용하면 그래프에 포함된 모든 노드를 출력할 수 있다.

```python
G.add_node(1)
print(G.nodes())
```

출력 결과는 1이다!

![](/assets/images/2024-04-02-23-27-51.png)


문자나 문자열도 라벨로 지정할 수 있다.

```python
G.add_node('P')
G.add_node('Hi')
print(G.nodes())
```
![](/assets/images/2024-04-02-23-28-36.png)
그래프에 포함된 모든 노드를 출력하면 [1, 'P', 'Hi'] 가 나온다.

그럼 한 번에 여러 개의 노드를 삽입할 수는 없을까?

> ##### add_nodes_from() 메소드를 사용하면 리스트 형태의 데이터 입력이 가능하다!

```python
G.add_nodes_from([2, 3])
print(G.nodes())
```

![](/assets/images/2024-04-02-23-29-12.png)

2, 3 노드가 한 번에 추가되었다. 

---

지금까지 작성된 그래프 G에 입력된 노드들을 한 줄씩 출력해보자.

```python
for node in G.nodes(): #그래프의 모든 노드를 한 줄씩 출력
    print(node)
```
![](/assets/images/2024-04-02-23-27-03.png)

그렇다면, 이미 존재하는 노드를 다시 추가하면 어떻게 될까?

```python
G.add_nodes_from([3,4]) 
print(G.nodes()) 
```

![](/assets/images/2024-04-03-20-10-37.png)

출력 결과를 보면 3의 노드는 이미 존재하기 때문에 4의 노드만 추가된 것을 확인할 수 있다.

-------
#### 2. 그래프를 그림으로 출력하기

그래프를 리스트로만 보려니 답답하다!

그래프를 그림으로 출력해보자.

draw() 메소드를 사용하면 된다.

이 때, with_labels=True는 라벨을 노드 위에 함께 출력한다는 의미이다. False를 넣으면 라벨은 생략하고 출력된다.

```python
nx.draw(G, with_labels = True, node_color='lightblue')
```
![](/assets/images/2024-04-03-20-14-38.png)

이렇게 둥근 노드 위에 각각의 라벨이 표시되어 출력되었다.

이제 노드와 노드 사이를 연결하는 선인 엣지를 입력해보자.

add_edge() 메소드를 사용한다.

edge_color()을 추가해 엣지의 색상도 지정할 수 있다.

```python
G.add_edge(1,2)
nx.draw(G, with_labels=True, node_color='lightblue', edge_color='grey')
```

![](/assets/images/2024-04-03-20-19-17.png)

1의 노드와 2의 노드를 연결하는 엣지가 생겼다!

노드의 연결 상태를 라스트 형태로도 확인 가능하다.

```python
print(G.edges()) #연결 상태를 리스트 형태로 확인
```

![](/assets/images/2024-04-03-20-20-48.png)

----

> 만약 엣지를 연결할 때 기존에 없던 노드를 연결하면 어떻게 될까?

```python
G.add_edge(4,5) #존재하지 않는 5의 노드와 연결
print(G.edges()) # 5의 노드 생성 후 4와 연결
```
![](/assets/images/2024-04-04-00-29-37.png)

위의 코드처럼 기존의 노드를 새로운 노드와 연결하는 엣지를 추가하면, 새로운 노드를 생성한 후 연결한다.

-------

add_nodes_from() 메소드처럼 add_edges_from()메소드를 이용해 여러 개의 엣지들을 한 번에 만들 수 있다.

1개 이상의 튜플을 리스트 형식으로 묶어서 입력하면 된다.

1과 P노드 사이의 엣지와 1과 Hi 노드 사이의 엣지를 만든 후, 전체 그래프를 그리는 코드를 작성해봤다.

```python
G.add_edges_from([(1, 'P'), (1, 'Hi')])
nx.draw(G, with_labels=True, node_color='yellow', edge_color="red")
```

![](/assets/images/2024-04-04-00-35-14.png)

--------

#### 3. 다수의 노드와 엣지를 동시에 생성하기

path_graph() 와 add_path() 메소드를 사용할 수 있다.

> ##### path_graph() 메소드
 먼저, 아래의 예시처럼 path_graph(4)를 입력하면 0부터 3까지의 노드를 생성하고 그들을 잇는 엣지들이 만들어진다.

 ```python
import networkx as nx
G = nx.path_graph(4)
nx.draw(G, with_labels=True, node_color='lightblue', edge_color="red" ) 
```

![](/assets/images/2024-04-04-00-43-22.png)

#### add_path() 메소드
add_path() 메소드에 리스트를 입력해 노드와 엣지를 생성할 수도 있다.  

```python
G = nx.Graph()
nx.add_path(G, [0,1,2,3])
nx.draw(G, with_labels=True, node_color='lightblue', edge_color="red" )
```
이렇게 작성하면 그래프 G에 0,1,2,3의 노드들이 생성되고 이들을 잇는 엣지도 자동으로 생성된다.

![](/assets/images/2024-04-04-00-48-31.png)

-----

#### 4. 노드의 degree(차수) 구하기

degree(차수)는 특정 노드에 연결된 엣지의 개수를 의미한다. 

degree()메소드를 사용해 모든 노드의 차수를 구할 수 있는데, 

사전 형식으로 모든 노드에 대한 차수를 쌍으로 저장한다.

예시 코드를 통해 자세히 알아보자!

주석을 달아 설명을 덧붙였다.

```python
G = nx.Graph()
nx.add_path(G, [0,1,2,3])
print(G.degree(0)) #노드 0에 대한 차수만 출력
print(G.degree([0,1])) #노드 0,1 에 대한 차수 출력 (1,2)는 노드 1이 엣지 2개를 가져서 degree=2 라는 의미.
print(G.degree()) #모든 노드에 대한 차수 출력
```
출력 결과

![](/assets/images/2024-04-04-00-53-24.png)

-----

#### 5. 노드 / 엣지의 삭제

필요 없는 노드나 엣지를 삭제해보자.

> ##### 노드 삭제
remove_node() 메소드를 이용한다.

삭제하고자 하는 노드의 라벨을 입력하면 된다.

예시로 2의 노드를 삭제해보겠다.

```python
print(G.nodes())
G.remove_node((2))
print(G.nodes())
```

![](/assets/images/2024-04-04-01-00-13.png)

출력 결과를 보면, 2의 노드가 잘 삭제되었다.

다수의 노드를 한꺼번에 삭제할 수는 없을까?

물론... 가능하다.

remove_nodes_from() 메소드를 사용, 리스트 형태로 입력한다.

예시 코드를 보자.

```python
print(G.nodes())
G.remove_nodes_from([0,1,3])
print(G.nodes())
```

![](/assets/images/2024-04-04-01-02-25.png)

이렇게 한꺼번에 모든 노드를 삭제할 수 있다.


> ##### 엣지 삭제

엣지를 삭제하는 방법도 노드의 경우와 아주 유사하다.

remove_edge() 혹은 remove_edges_from() 메소드를 사용한다.

노드 삭제와 마찬가지로 전자는 1개의 엣지를 삭제할 때 사용하고, 후자는 여러 개의 엣지를 한 번에 삭제할 때 사용할 수 있다.

```python
print(G.edges())
G.remove_edge(1,2)
print(G.edges())
```

1 노드와 2 노드 사이의 엣지를 삭제하도록 하고 출력 결과를 보면,

![](/assets/images/2024-04-04-01-06-36.png)

잘 삭제되었다.

다수의 엣지를 한 번에 삭제하는 경우도 살펴보자.

```python
print(G.edges())
G.remove_edges_from([(0,1), (2,3)])
print(G.edges())
```

![](/assets/images/2024-04-04-01-08-40.png)

-----

#### 5. 노드 / 엣지의 개수 

생성한 노드나 엣지들의 개수를 알고싶다면

number_of_nodes()나 number_of_edges() 메소드를 사용한다.

예시 코드를 살펴보자!

```python
import networkx as nx
G = nx.Graph()
G.add_nodes_from([1, 2, 3, 4, 5])
G.add_edges_from([(1,2), (1,3), (1,4), (1,5), (4,5)])
print('No. nodes:', G.number_of_nodes())
print('No. edges:', G.number_of_edges())
```

![](/assets/images/2024-04-04-01-12-54.png)

노드와 엣지의 개수가 각각 5개로 잘 출력된다.

그런데, 노드를 삭제하면 연결된 엣지도 어떻게 될까?

노드의 생성과 삭제 과정을 거쳐 노드와 엣지의 개수를 비교해보았다.

```python
import networkx as nx
G = nx.Graph()
G.add_nodes_from([1, 2, 3, 4, 5])
G.add_edges_from([(1,2), (1,3), (1,4), (1,5), (4,5)])
G.remove_node(3) # 노드를 삭제하면 3 노드와 연결되어있던 엣지도 자동으로 삭제됨
print('No. nodes:', G.number_of_nodes())
print('No. edges:', G.number_of_edges())
```
![](/assets/images/2024-04-04-01-16-41.png)

결과를 보면, 삭제된 3의 노드에 연결되어 있던 1-3 엣지도 삭제되었음을 알 수 있다!




